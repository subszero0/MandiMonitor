# ðŸ“‚ Repository Scaffold â€” **@MandiMonitorBot**

Below is the **initial folder tree** plus minimal stubs for each file so Cursor can start generating code pieceâ€‘byâ€‘piece. Feel free to rename or rearrange.

```text
mandi-monitor-bot/
â”œâ”€ .gitignore
â”œâ”€ .env.example
â”œâ”€ Dockerfile
â”œâ”€ docker-compose.yml
â”œâ”€ README.md
â”œâ”€ pyproject.toml            # generated by Poetry (placeholder shown)
â”œâ”€ backup_db.sh              # cron backup script
â”œâ”€ bot/
â”‚  â”œâ”€ __init__.py
â”‚  â”œâ”€ main.py                # Telegram webhook entrypoint
â”‚  â”œâ”€ config.py              # loads env vars
â”‚  â”œâ”€ handlers.py            # /start, /watch, etc.
â”‚  â”œâ”€ scheduler.py           # APScheduler job setup
â”‚  â”œâ”€ models.py              # SQLModel classes
â”‚  â”œâ”€ paapi_wrapper.py       # Amazon PAâ€‘API helper
â”‚  â”œâ”€ scraper.py             # Playwright fallback
â”‚  â”œâ”€ carousel.py            # build Telegram album messages
â”‚  â””â”€ admin.py               # Flask admin blueprint
â””â”€ tests/
   â””â”€ test_paapi.py          # pytest stub
```

---

## 1Â Â `.gitignore`

```
# Python
__pycache__/
*.py[cod]
*.sqlite3

# Env & secrets
.env

# Docker
*.log
```

## 2Â Â `.env.example`

```
TELEGRAM_TOKEN="YOUR_TELEGRAM_BOT_TOKEN"
PAAPI_ACCESS_KEY=""
PAAPI_SECRET_KEY=""
PAAPI_TAG="YOURTAG-21"
ADMIN_USER="admin"
ADMIN_PASS="changeme"
SENTRY_DSN=""
TIMEZONE="Asia/Kolkata"
```

## 3Â Â `Dockerfile` (multiâ€‘stage)

```dockerfile
FROM python:3.12-slim AS builder
WORKDIR /app
COPY pyproject.toml .
RUN pip install --upgrade pip && pip install poetry && poetry config virtualenvs.create false && poetry install --no-dev

FROM python:3.12-slim
WORKDIR /app
COPY --from=builder /usr/local/lib/python3.12/site-packages /usr/local/lib/python3.12/site-packages
COPY bot/ bot/
COPY backup_db.sh ./backup_db.sh
ENTRYPOINT ["python", "-m", "bot.main"]
```

## 4Â Â `docker-compose.yml`

```yaml
version: "3.9"
services:
  bot:
    build: .
    env_file: .env
    restart: unless-stopped
    volumes:
      - ./dealbot.db:/app/dealbot.db
  cloudflared:
    image: cloudflare/cloudflared:latest
    command: tunnel run --url http://bot:8000
    env_file: .env
    restart: unless-stopped
```

## 5Â Â `pyproject.toml` (minimal)

```toml
[tool.poetry]
name = "mandi-monitor-bot"
version = "0.1.0"
description = "Telegram bot that alerts Indian shoppers on deep discounts."
authors = ["Your Name <you@example.com>"]

[tool.poetry.dependencies]
python = "^3.12"
python-telegram-bot = "^21.0"
SQLModel = "^0.0.14"
APScheduler = "^3.10.4"
python-amazon-paapi = "^5.0.0"
playwright = "^1.45.0"
Flask = "^3.0"
sentry-sdk = "^2.0.0"
uvicorn = "^0.29.0"

[build-system]
requires = ["poetry-core>=1.0.0"]
build-backend = "poetry.core.masonry.api"
```

## 6Â Â `bot/main.py` (stub)

```python
from bot.config import settings
from bot.handlers import setup_handlers
from telegram.ext import ApplicationBuilder

app = ApplicationBuilder().token(settings.TELEGRAM_TOKEN).build()
setup_handlers(app)

if __name__ == "__main__":
    app.run_polling()
```

## 7Â Â `bot/config.py`

```python
import os
from pydantic import BaseSettings

class Settings(BaseSettings):
    TELEGRAM_TOKEN: str
    PAAPI_ACCESS_KEY: str | None = None
    PAAPI_SECRET_KEY: str | None = None
    PAAPI_TAG: str | None = None
    ADMIN_USER: str = "admin"
    ADMIN_PASS: str = "changeme"
    SENTRY_DSN: str | None = None
    TIMEZONE: str = "Asia/Kolkata"

settings = Settings(_env_file=".env")
```

## 8Â Â `backup_db.sh`

```bash
#!/usr/bin/env bash
set -e
DATE=$(date +%F)
bucket="lightsail-backups"
file="dealbot.db"
aws s3 cp $file s3://$bucket/$DATE/$file
```

## 9Â Â `README.md` (outline)

```md
# MandiMonitorBot

Telegram bot that hunts Indiaâ€‘specific eâ€‘commerce deals and pings you when prices crash.

## Quick Start
```

Fill with setup instructions after first successful run.

---

**Next step:** commit & push these stubs (Phase 0 tasks), then start implementing PhaseÂ 1 (credentials & helloâ€‘world bot).

